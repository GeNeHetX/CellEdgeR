[{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"brief-intro","dir":"Articles","previous_headings":"","what":"Brief intro","title":"CellEdgeR technical note","text":"CellEdgeR builds Delaunay graphs spatial cell coordinates, counts cell-type motifs (nodes, edges, triangles, optional wedges), tests differential abundance using edgeR graph-aware offsets.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick start","title":"CellEdgeR technical note","text":"Just want lines code run analysis?","code":"library(CellEdgeR)  samples_list <- make_demo_samples(n_cells = 2000, seed = 1) metadata_df <- data.frame(   condition = rep(c(\"ctrl\", \"treated\"), each = length(samples_list) / 2),   row.names = names(samples_list) )  cellgraph <- build_cell_graphs(samples_list, n_cores = 2) cellgraph <- count_motifs_graphs(cellgraph, max_edge_len = 50, n_cores = 2) cellgraph <- motif_edger(   cellgraph,   sample_df = metadata_df,   design_formula = \"~ condition\",   strategies = c(\"volume\", \"ancova\") )  top_motifs(cellgraph, strategy = \"hybrid\", coef = \"conditiontreated\")"},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"methodology-volume-and-hybrid","dir":"Articles","previous_headings":"","what":"Methodology (volume and hybrid)","title":"CellEdgeR technical note","text":"section technical note aimed readers want understand statistical model assumptions.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"delaunay-graphs-and-motif-layers","dir":"Articles","previous_headings":"Methodology (volume and hybrid)","what":"Delaunay graphs and motif layers","title":"CellEdgeR technical note","text":"sample, CellEdgeR builds Delaunay triangulation 2D coordinates treats unique edges candidate adjacency. Optional pruning max_edge_len removes long edges counting motifs. Motifs counted pruned graph stored layer: Nodes: N_<label> Edges: E_<label1>_<label2> (unordered) Triangles: T_<label1>_<label2>_<label3> (unordered) Wedges: W_<label1>_<label2>_<label3> (unordered, optional) Counts per sample, yielding motif--sample matrix layer.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"volume-exposure-and-offsets","dir":"Articles","previous_headings":"Methodology (volume and hybrid)","what":"Volume exposure and offsets","title":"CellEdgeR technical note","text":"volume approach uses label-specific “volumes” represent much graph available label sample. Volumes computed node degrees Delaunay graph: label, sum degrees nodes label. Let 2m twice number edges sample. Offsets log expected counts Chung-Lu style random graph preserves volumes: Nodes: log(total cells) optional TMM correction node layer. Edges: log(vol_a) + log(vol_b) - log(2m) Triangles: log(vol_a) + log(vol_b) + log(vol_c) - 2 * log(2m) Wedges: volume scaling triangles (optional). small offset_pseudo used avoid log(0).","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"volume-model","dir":"Articles","previous_headings":"Methodology (volume and hybrid)","what":"Volume model","title":"CellEdgeR technical note","text":"motif, counts modeled negative binomial GLM (edgeR QL) volume offset. design matrix comes design_formula can include multiple covariates. resulting logFC interpreted change motif rate relative volume baseline. Use top_motifs(..., strategy = \"volume\") extract results model.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"hybrid-model","dir":"Articles","previous_headings":"Methodology (volume and hybrid)","what":"Hybrid model","title":"CellEdgeR technical note","text":"hybrid strategy applies: volume model node edge motifs. ANCOVA-style per-motif model triangle wedge motifs, using volume offsets plus covariate derived expected edge structure. adjusts higher-order motifs lower-order (edge) composition preserving baseline exposure. Hybrid results returned top_motifs(..., strategy = \"hybrid\"). FDR computed separately node/edge motifs triangle/wedge motifs.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"assumptions","dir":"Articles","previous_headings":"Methodology (volume and hybrid)","what":"Assumptions","title":"CellEdgeR technical note","text":"Delaunay edges reasonable proxy spatial adjacency sample. Pruning max_edge_len removes long-range edges without removing meaningful local adjacency. Cell labels accurate consistent across samples. Samples independent, motif counts follow negative binomial model. volume offsets approximate expected counts graph preserved label volumes (degree sums) total edge count.","code":""},{"path":[]},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"concepts-and-terminology","dir":"Articles","previous_headings":"User guide","what":"Concepts and terminology","title":"CellEdgeR technical note","text":"Sample: single spatial dataset (one slide, region, image). cellgraph: main object produced build_cell_graphs() augmented count_motifs_graphs() motif_edger(). Motif: node, edge, triangle, wedge defined labels counted per sample. Offset: log expected count used GLM normalize exposure. Strategy: volume hybrid modeling choice used top_motifs().","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"required-inputs","dir":"Articles","previous_headings":"User guide","what":"Required inputs","title":"CellEdgeR technical note","text":"Column 1: numeric x coordinate Column 2: numeric y coordinate Column 3: label (character factor) sample_df: data frame one row per sample row names equal names(cells_by_sample).","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"build-graphs-and-count-motifs","dir":"Articles","previous_headings":"User guide","what":"Build graphs and count motifs","title":"CellEdgeR technical note","text":"","code":"cellgraph <- build_cell_graphs(cells_by_sample, n_cores = 4) cellgraph <- count_motifs_graphs(   cellgraph,   max_edge_len = 50,   include_wedge = TRUE,   n_cores = 4 )"},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"choose-a-delaunay-cutoff-max_edge_len","dir":"Articles","previous_headings":"User guide","what":"Choose a Delaunay cutoff (max_edge_len)","title":"CellEdgeR technical note","text":"Inspect edge-length distribution choose cutoff removes long tail keeping local neighbors. cutoff units coordinates.","code":"edge_lengths <- unlist(lapply(cellgraph$per_sample_graph, function(ps) ps$edge_len))  ggplot2::ggplot(data.frame(edge_len = edge_lengths), ggplot2::aes(edge_len)) +   ggplot2::geom_density(fill = \"#4477aa\", alpha = 0.3, color = \"#223355\") +   ggplot2::scale_x_log10(\"Edge length (log scale)\") +   ggplot2::ylab(\"Density\") +   ggplot2::ggtitle(\"Edge length distribution (density, log-x)\") +   ggplot2::theme_minimal()"},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"differential-analysis-and-multivariate-designs","dir":"Articles","previous_headings":"User guide","what":"Differential analysis and multivariate designs","title":"CellEdgeR technical note","text":"formula can include multiple covariates, interactions, continuous variables (example ~ condition + batch + age).","code":"cellgraph <- motif_edger(   cellgraph,   sample_df = sample_df,   design_formula = \"~ condition + batch\",   strategies = c(\"volume\", \"ancova\") )  top_motifs(cellgraph, strategy = \"hybrid\", coef = \"conditiontreated\") top_motifs(cellgraph, strategy = \"volume\", coef = \"conditiontreated\")"},{"path":"https://GeNeHetX.github.io/CellEdgeR/articles/technical-note.html","id":"plotting-motifs","dir":"Articles","previous_headings":"User guide","what":"Plotting motifs","title":"CellEdgeR technical note","text":"Spatial plot motif within sample: Quantification motifs across samples:","code":"plot_sample_graph(   cellgraph,   sample_name = \"s1\",   max_edge_len = 50,   motif_key = \"E_a_b\",   motif_node_size = 0.8 ) norm_df <- get_motif_values(cellgraph, value = \"norm\") df_plot <- data.frame(sample = rownames(norm_df), value = norm_df[[\"T_a_b_c\"]]) df_plot <- merge(df_plot, sample_df, by.x = \"sample\", by.y = \"row.names\", all.x = TRUE)  ggplot2::ggplot(df_plot, ggplot2::aes(x = condition, y = value, fill = condition)) +   ggplot2::geom_boxplot() +   ggplot2::geom_jitter(width = 0.1, alpha = 0.6) +   ggplot2::ylab(\"Normalized motif count (volume offsets)\") +   ggplot2::xlab(\"condition\")"},{"path":"https://GeNeHetX.github.io/CellEdgeR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Remy Nicolle. Author, maintainer.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Nicolle R (2026). CellEdgeR: Differential Analysis Cell Edge Motifs edgeR. R package version 0.1.2.","code":"@Manual{,   title = {CellEdgeR: Differential Analysis of Cell Edge Motifs with edgeR},   author = {Remy Nicolle},   year = {2026},   note = {R package version 0.1.2}, }"},{"path":"https://GeNeHetX.github.io/CellEdgeR/index.html","id":"celledger","dir":"","previous_headings":"","what":"Differential Analysis of Cell Edge Motifs with edgeR","title":"Differential Analysis of Cell Edge Motifs with edgeR","text":"Differential analysis cell-type interaction motifs spatial coordinates.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Differential Analysis of Cell Edge Motifs with edgeR","text":"CellEdgeR builds per-sample Delaunay graphs, counts motifs (nodes, edges, triangles, optional wedges), fits edgeR models. Offsets computed stored cellgraph (offset modes: volume, hier_null): - Node offsets: log(total cells) + log(TMM) available. - Edge/triangle/wedge offsets: structural Chung-Lu (volume-based). Motif keys prefixed layer: N_ (nodes), E_ (edges), T_ (triangles), W_ (wedge), TW_ triangles/wedge merged modeling.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Differential Analysis of Cell Edge Motifs with edgeR","text":"Install dependencies install package:","code":"install.packages(c(\"geometry\", \"Matrix\")) if (!requireNamespace(\"BiocManager\", quietly = TRUE)) install.packages(\"BiocManager\") if (!requireNamespace(\"edgeR\", quietly = TRUE)) BiocManager::install(\"edgeR\")  devtools::install_github(\"GeNeHetX/CellEdgeR\") library(CellEdgeR)"},{"path":"https://GeNeHetX.github.io/CellEdgeR/index.html","id":"typical-workflow","dir":"","previous_headings":"","what":"Typical workflow","title":"Differential Analysis of Cell Edge Motifs with edgeR","text":"Prepare data Provide named list samples. element data frame numeric x, y coordinates first two columns label vector (cell type, cluster, etc.) third column. Build graphs, count motifs (cellgraph object) build_cell_graphs() returns cellEdgeR_obj per-sample Delaunay graphs. count_motifs_graphs() reuses object adds motif counts, exposures, offsets, normalized counts, relative counts, run parameters. Offsets, normalized counts, relative counts stored per offset mode (e.g., cellgraph$norm_counts$volume, cellgraph$norm_counts$hier_null). Fit differential models (offsets already computed) motif_edger() runs volume ancova strategies default stores results cellgraph$edger$strategies. top_motifs() defaults hybrid strategy (volume node/edge motifs ancova triangle/wedge motifs), reports model_used motif. Inspect/visualize motifs (optional)","code":"samples_list <- make_demo_samples(n_cells=10000,seed = 42) # enriches T_a_b_c in the second half by default  metadata_df <- data.frame(   condition = rep(c(\"ctrl\", \"treated\"), each = length(samples_list) / 2),   batch = sample(c(\"batch1\", \"batch2\"), length(samples_list), replace = TRUE),   row.names = names(samples_list) ) cellgraph <- build_cell_graphs(samples_list, n_cores = 4, verbose = TRUE) cellgraph <- count_motifs_graphs(   cellgraph,   max_edge_len = 50,     # set NA/NULL/<=0 to disable pruning   include_wedge = TRUE,   n_cores = 4 ) cellgraph <- motif_edger(   cellgraph = cellgraph,   sample_df = metadata_df,  # rownames must match sample names   design_formula = \"~ condition + batch\",   merge_triplets = FALSE    # set TRUE to merge triangles+wedge as TW_* )  diff_tbl <- top_motifs(cellgraph, coef = \"conditiontreated\") head(diff_tbl) norm_df <- get_motif_values(cellgraph, value = \"norm\") head(norm_df) library(ggplot2)  motif_key <- \"T_a_b_c\" df_plot <- data.frame(sample = rownames(norm_df), value = norm_df[[motif_key]]) df_plot <- merge(df_plot, metadata_df, by.x = \"sample\", by.y = \"row.names\", all.x = TRUE) ggplot(df_plot, aes(x = condition, y = value, fill = condition)) +   geom_boxplot() +   geom_jitter(width = 0.1, alpha = 0.6) +   ylab(paste0(\"Normalized (log2) count: \", motif_key)) +   xlab(\"condition\") plot_sample_graph(   cellgraph,   sample_name = \"s1\",   max_edge_len = 50,   motif_key = \"E_a_b\",   motif_node_size=0.5,   dim_node_nonmotif = 0.1,   alpha_node_nonmotif = 0.2,   alpha_edge_nonmotif = 0.2 )"},{"path":"https://GeNeHetX.github.io/CellEdgeR/index.html","id":"choosing-a-pruning-threshold","dir":"","previous_headings":"","what":"Choosing a pruning threshold","title":"Differential Analysis of Cell Edge Motifs with edgeR","text":"max_edge_len threshold controls Delaunay edges retained motif counting. pick cutoff, inspect edge-length distribution drop sparse tail preserving biologically relevant neighbors.","code":"edge_lengths <- unlist(lapply(cellgraph$per_sample_graph, function(ps) ps$edge_len)) summary(edge_lengths)  ggplot2::ggplot(data.frame(edge_len = edge_lengths), ggplot2::aes(edge_len)) +   ggplot2::geom_density(fill = \"#4477aa\", alpha = 0.3, color = \"#223355\") +   ggplot2::scale_x_log10(\"Edge length (log scale)\") +   ggplot2::ylab(\"Density\") +   ggplot2::ggtitle(\"Edge length distribution (density, log-x)\") +   ggplot2::theme_minimal()"},{"path":"https://GeNeHetX.github.io/CellEdgeR/index.html","id":"tips","dir":"","previous_headings":"","what":"Tips","title":"Differential Analysis of Cell Edge Motifs with edgeR","text":"Reuse graph_obj experimenting pruning wedge option (include_wedge) avoid rerunning triangulation. Record max_edge_len used run downstream results stay traceable. quick inspection, use get_motif_values(cellgraph, value = \"norm\") apply plotting/statistics. get_motif_values(..., value = \"norm\") uses volume offsets , matching hybrid modeling offsets.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/index.html","id":"glossary","dir":"","previous_headings":"","what":"Glossary","title":"Differential Analysis of Cell Edge Motifs with edgeR","text":"make_demo_samples(): Create synthetic named list samples quick testing (defaults boosted T_a_b_c motif second half; set boost_motif = FALSE disable). build_cell_graphs(): Build per-sample Delaunay graphs coordinates labels. count_motifs_graphs(): Count node/edge/triangle (optional wedge) motifs compute offsets/normalization. merge_motif_objs(): Merge two motif objects recompute offsets/normalized counts. motif_edger(): Fit differential motif models (volume, ancova) store results. top_motifs(): Return ranked data frame motifs chosen strategy/coef. get_motif_values(): Return raw/normalized motif values (optionally including lower-order submotifs; normalized uses volume offsets). plot_sample_graph(): Plot one sample’s graph highlight motifs. cellEdgeR_obj: Main object storing sample_name, counts, exposures, offsets, edgeR results. cellEdgeR_graphs: Graph-object per_sample_graph ready motif counting.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/build_cell_graphs.html","id":null,"dir":"Reference","previous_headings":"","what":"Build cached cell graphs for motif counting — build_cell_graphs","title":"Build cached cell graphs for motif counting — build_cell_graphs","text":"Builds constrained Delaunay triangulation sample caches raw edges multiple motif-counting passes can reuse triangulation.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/build_cell_graphs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build cached cell graphs for motif counting — build_cell_graphs","text":"","code":"build_cell_graphs(cells_by_sample, n_cores = 1, verbose = TRUE, max_labels = 100)"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/build_cell_graphs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build cached cell graphs for motif counting — build_cell_graphs","text":"cells_by_sample Named list data frames first two columns numeric x, y coordinates     third column holds cell-type label. Names list treated sample names. n_cores Integer number cores request; values greater 1 trigger parallel::mclapply Unix-alikes, 1 runs sequentially. verbose Logical; print progress messages standardization graph construction. max_labels Maximum number unique labels allowed across samples (fails early exceeded).","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/build_cell_graphs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Build cached cell graphs for motif counting — build_cell_graphs","text":"helper performs expensive Delaunay triangulation step records every edge's length. Pass returned cellEdgeR_graphs object count_motifs_graphs(graph_obj = ...) compute motif counts without re-running triangulation, even pruning wedge options change.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/build_cell_graphs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build cached cell graphs for motif counting — build_cell_graphs","text":"list class cellEdgeR_graphs containing: sample_name Character vector sample names. label_levels/lab_to_id Sorted unique cell-type labels global label--integer lookup. per_sample_graph Per-sample entries storing n (node count), labels_chr, labels_id, edges, edge lengths edge_len, coordinates xy. raw_count/exposure/offsets/norm_counts/relative_counts Empty placeholders count_motifs_graphs() called. edger Empty placeholder motif_edger() called. parameters Build parameters (placeholders max_edge_len, offset_pseudo, built_from).","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/build_cell_graphs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build cached cell graphs for motif counting — build_cell_graphs","text":"","code":"cells <- list(   s1 = data.frame(x = c(0, 1, 0), y = c(0, 0, 1), label = c(\"A\", \"A\", \"B\")),   s2 = data.frame(x = c(0, 2, 0), y = c(0, 0, 2), label = c(\"A\", \"B\", \"B\")) ) graphs <- build_cell_graphs(cells, verbose = FALSE) counts <- count_motifs_graphs(graph_obj = graphs, max_edge_len = 3, verbose = FALSE) #> Warning: no non-missing arguments to max; returning -Inf #> Warning: no non-missing arguments to max; returning -Inf"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/build_pair_offsets.html","id":null,"dir":"Reference","previous_headings":"","what":"Build motif offsets for normalized counts and modeling — build_pair_offsets","title":"Build motif offsets for normalized counts and modeling — build_pair_offsets","text":"Build motif offsets normalized counts modeling","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/build_pair_offsets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build motif offsets for normalized counts and modeling — build_pair_offsets","text":"","code":"build_pair_offsets(Y2, log_vols, log_2m, pseudo)"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/count_motifs_graphs.html","id":null,"dir":"Reference","previous_headings":"","what":"Count cell-type motifs on spatial graphs — count_motifs_graphs","title":"Count cell-type motifs on spatial graphs — count_motifs_graphs","text":"Reuses constrained Delaunay triangulation, prunes edges exceed max\\_edge\\_len, counts cell-type singletons, unordered pairs (edges), unordered triplets (triangles). Triangle counts accelerated via C++ helper exposed CellEdgeR.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/count_motifs_graphs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count cell-type motifs on spatial graphs — count_motifs_graphs","text":"","code":"count_motifs_graphs(graph_obj, max_edge_len = NA_real_, include_wedge = FALSE, verbose = TRUE,   offset_pseudo = 1, n_cores = 1)"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/count_motifs_graphs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count cell-type motifs on spatial graphs — count_motifs_graphs","text":"graph_obj Output build_cell_graphs(); triangulation reused pruning/wedge parameters applied . max_edge_len Numeric edge-length threshold; Delaunay edges longer dropped counting.     Set NA, NULL, <= 0 keep full Delaunay graph. include_wedge Logical flag; TRUE also counts open three-node paths (wedge) records counts\\$wedge plus exposure\\$wedge. verbose Logical; print progress messages graph construction, counting stages, (enabled) wedge collection. offset_pseudo Small positive constant used inside offsets. n_cores Parallelism hint motif counting; values greater 1 trigger parallel::mclapply Unix-alikes, 1 runs sequentially.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/count_motifs_graphs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Count cell-type motifs on spatial graphs — count_motifs_graphs","text":"samples share global label vocabulary counts align across matrices. Call build_cell_graphs() create reusable triangulation, reuse across different pruning/wedge configurations. Counts sparse Matrix objects (node cells, edge pairs, triangle triplets, plus wedge requested). Enabling wedge adds counts\\$wedge exposure\\$wedge; latter also reports wedge totals alongside edge/triangle exposures.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/count_motifs_graphs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count cell-type motifs on spatial graphs — count_motifs_graphs","text":"named list entries: sample_name Character vector sample names (names cells_by_sample). label_levels/lab_to_id Sorted unique cell-type labels integer lookup. per_sample_graph Cached per-sample graph structures (edges, lengths, labels, coordinates). raw_count Sparse matrices node, edge, triangle, optional wedge motifs (rows = motifs, cols = samples). exposure Totals used offsets: cells, edges, triangles, volumes per label×sample, wedge requested. offsets Offset sets (e.g., volume, hier_null), containing log-expected matrices per layer.   Node offsets adjusted TMM factors; layers use structural offsets . norm_counts Normalized counts per offset set (counts / exp(offset)). relative_counts edgeR intercept-log2 residuals per offset set. offset_part_id offset set, components contributing motif's offset. offset_part_values Numeric values referenced offset_part_id (e.g., volumes, 2m, edge posteriors). edger edgeR fits/tests motif_edger() run. parameters Run parameters (e.g., max_edge_len, include_wedge, offset_pseudo, available offset_modes, layer names, node_tmm_offsets flag).","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/count_motifs_graphs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count cell-type motifs on spatial graphs — count_motifs_graphs","text":"","code":"cells <- list(   s1 = data.frame(x = c(0, 1, 0), y = c(0, 0, 1), label = c(\"A\", \"A\", \"B\")),   s2 = data.frame(x = c(0, 2, 0), y = c(0, 0, 2), label = c(\"A\", \"B\", \"B\")) ) graphs <- build_cell_graphs(cells, verbose = FALSE) counts <- count_motifs_graphs(graph_obj = graphs, max_edge_len = 3, verbose = FALSE) #> Warning: no non-missing arguments to max; returning -Inf #> Warning: no non-missing arguments to max; returning -Inf counts_full <- count_motifs_graphs(graph_obj = graphs, max_edge_len = NA_real_, include_wedge = TRUE, verbose = FALSE) #> Warning: no non-missing arguments to max; returning -Inf #> Warning: no non-missing arguments to max; returning -Inf str(counts_full$raw_count) #> List of 4 #>  $ node    :Formal class 'dgCMatrix' [package \"Matrix\"] with 6 slots #>   .. ..@ i       : int [1:4] 0 1 0 1 #>   .. ..@ p       : int [1:3] 0 2 4 #>   .. ..@ Dim     : int [1:2] 2 2 #>   .. ..@ Dimnames:List of 2 #>   .. .. ..$ : chr [1:2] \"N_A\" \"N_B\" #>   .. .. ..$ : chr [1:2] \"s1\" \"s2\" #>   .. ..@ x       : num [1:4] 2 1 1 2 #>   .. ..@ factors : list() #>  $ edge    :Formal class 'dgCMatrix' [package \"Matrix\"] with 6 slots #>   .. ..@ i       : int [1:4] 0 1 1 2 #>   .. ..@ p       : int [1:3] 0 2 4 #>   .. ..@ Dim     : int [1:2] 3 2 #>   .. ..@ Dimnames:List of 2 #>   .. .. ..$ : chr [1:3] \"E_A_A\" \"E_A_B\" \"E_B_B\" #>   .. .. ..$ : chr [1:2] \"s1\" \"s2\" #>   .. ..@ x       : num [1:4] 1 2 2 1 #>   .. ..@ factors : list() #>  $ triangle:Formal class 'dgCMatrix' [package \"Matrix\"] with 6 slots #>   .. ..@ i       : int [1:2] 0 1 #>   .. ..@ p       : int [1:3] 0 1 2 #>   .. ..@ Dim     : int [1:2] 2 2 #>   .. ..@ Dimnames:List of 2 #>   .. .. ..$ : chr [1:2] \"T_A_A_B\" \"T_A_B_B\" #>   .. .. ..$ : chr [1:2] \"s1\" \"s2\" #>   .. ..@ x       : num [1:2] 1 1 #>   .. ..@ factors : list() #>  $ wedge   :Formal class 'dgCMatrix' [package \"Matrix\"] with 6 slots #>   .. ..@ i       : int(0)  #>   .. ..@ p       : int [1:3] 0 0 0 #>   .. ..@ Dim     : int [1:2] 0 2 #>   .. ..@ Dimnames:List of 2 #>   .. .. ..$ : NULL #>   .. .. ..$ : chr [1:2] \"s1\" \"s2\" #>   .. ..@ x       : num(0)  #>   .. ..@ factors : list()"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/count_triangle_labels_cpp.html","id":null,"dir":"Reference","previous_headings":"","what":"Count triangles by unordered label triplets on an undirected graph. — count_triangle_labels_cpp","title":"Count triangles by unordered label triplets on an undirected graph. — count_triangle_labels_cpp","text":"Count triangles unordered label triplets undirected graph.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/count_triangle_labels_cpp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count triangles by unordered label triplets on an undirected graph. — count_triangle_labels_cpp","text":"","code":"count_triangle_labels_cpp(n_nodes, ei, ej, labels, label_ids, count_wedges)"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/count_triangle_labels_cpp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count triangles by unordered label triplets on an undirected graph. — count_triangle_labels_cpp","text":"n_nodes Number nodes. ei, ej Edge lists (1-based indices; length). labels Integer labels (1..K) node. label_ids Sequence 1..K (kept compatibility).","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/count_triangle_labels_cpp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count triangles by unordered label triplets on an undirected graph. — count_triangle_labels_cpp","text":"list keys (label triplets strings), counts, tri_total (total number triangles).","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/get_motif_values.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve motif values (raw, normalized) — get_motif_values","title":"Retrieve motif values (raw, normalized) — get_motif_values","text":"Pulls raw counts normalized counts motif (lower-order submotifs) samples--motifs data frame.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/get_motif_values.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve motif values (raw, normalized) — get_motif_values","text":"","code":"get_motif_values(cellgraph, motif_key = NULL, include_submotifs = FALSE,   value = c(\"raw\", \"norm\"))"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/get_motif_values.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve motif values (raw, normalized) — get_motif_values","text":"cellgraph cellEdgeR_obj returned count_motifs_graphs(). motif_key Character vector motif keys (e.g., E_A_B, T_A_B_C). NULL, return motifs. include_submotifs Logical; TRUE, include lower-order submotifs implied motif key (edges triangles/wedges, nodes edges). value value return: raw norm.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/get_motif_values.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve motif values (raw, normalized) — get_motif_values","text":"data frame sample names row names one column per motif. include_submotifs = TRUE, requested motifs appear first, followed unique submotifs.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/get_motif_values.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Retrieve motif values (raw, normalized) — get_motif_values","text":"Normalized values computed directly volume offsets match offsets used motif_edger() (including node TMM adjustments present). Call get_motif_values() multiple times retrieve different value types. Submotifs derived structurally (edges triangles/wedges, nodes edges) filtered motifs present object.","code":""},{"path":[]},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/get_motif_values.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve motif values (raw, normalized) — get_motif_values","text":"","code":"cells <- list(   s1 = data.frame(x = c(0, 1, 0), y = c(0, 0, 1), label = c(\"A\", \"A\", \"B\")),   s2 = data.frame(x = c(0, 2, 0), y = c(0, 0, 2), label = c(\"A\", \"B\", \"B\")) ) graphs <- build_cell_graphs(cells, verbose = FALSE) motifs <- count_motifs_graphs(graphs, max_edge_len = 3) #> Counting node motifs (cells by label)… #> Counting edge motifs (unordered label pairs)… #> Counting triangle motifs (unordered label triplets) in C++… #> Counts ready: |labels|=2, singles=2, pairs=3, triangles=2 #> Warning: no non-missing arguments to max; returning -Inf #> Warning: no non-missing arguments to max; returning -Inf tri_key <- rownames(motifs$raw_count$triangle)[1] get_motif_values(motifs, motif_key = tri_key, value = \"raw\") #>    T_A_A_B #> s1       1 #> s2       0 get_motif_values(motifs, motif_key = tri_key, value = \"norm\") #>    T_A_A_B #> s1   1.125 #> s2   0.000"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/get_norm_counts.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve normalized counts as a single data frame — get_norm_counts","title":"Retrieve normalized counts as a single data frame — get_norm_counts","text":"Pulls normalized motifs cellgraph (cellEdgeR_obj) one data frame row-binding layers.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/get_norm_counts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve normalized counts as a single data frame — get_norm_counts","text":"","code":"get_norm_counts(cellgraph, offset_mode = NULL, log2 = TRUE, pseudocount = 1)"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/get_norm_counts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve normalized counts as a single data frame — get_norm_counts","text":"cellgraph cellEdgeR_obj returned count_motifs_graphs(). offset_mode offset mode pull normalized counts ; defaults first available multiple stored. log2 Logical; TRUE (default), apply log2(count + pseudocount) normalized counts. pseudocount Small positive value added log transformation (default 1 match offset construction).","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/get_norm_counts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve normalized counts as a single data frame — get_norm_counts","text":"matrix/data frame samples rownames motifs column names.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/make_demo_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a synthetic dataset for quick testing — make_demo_samples","title":"Create a synthetic dataset for quick testing — make_demo_samples","text":"Generates named list sample data frames random coordinates labels, suitable exercising CellEdgeR workflow without real data. boost_motif TRUE, second half samples receives tightly clustered label triplets increase triangle motif (default labels: /b/c repeats fewer labels exist). number triplets scales n\\_cells.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/make_demo_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a synthetic dataset for quick testing — make_demo_samples","text":"","code":"make_demo_samples(n_cells = 300, n_labels = 3, n_samples = 24,   seed = NULL, boost_motif = TRUE)"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/make_demo_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a synthetic dataset for quick testing — make_demo_samples","text":"n_cells Number cells per sample. n_labels Number distinct labels (letters starting \"\"). n_samples Number samples generate. seed Optional integer seed reproducibility; NULL, current RNG state used. boost_motif Logical; TRUE, add clustered triplets enrich triangle motif second half samples.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/make_demo_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a synthetic dataset for quick testing — make_demo_samples","text":"named list data frames (one per sample) columns x, y, label.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/make_demo_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a synthetic dataset for quick testing — make_demo_samples","text":"","code":"demo_samples <- make_demo_samples(seed = 42) str(demo_samples[[1]]) #> 'data.frame':\t10000 obs. of  3 variables: #>  $ x    : num  0.915 0.937 0.286 0.83 0.642 ... #>  $ y    : num  0.528 0.646 0.834 0.346 0.622 ... #>  $ label: chr  \"c\" \"a\" \"b\" \"a\" ..."},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/merge_motif_objs.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge motif objects — merge_motif_objs","title":"Merge motif objects — merge_motif_objs","text":"Combine two cellEdgeR_obj outputs count_motifs_graphs() single object recomputed offsets normalized counts.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/merge_motif_objs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge motif objects — merge_motif_objs","text":"","code":"merge_motif_objs(motif_obj_a, motif_obj_b, verbose = TRUE)"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/merge_motif_objs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge motif objects — merge_motif_objs","text":"motif_obj_a,motif_obj_b cellEdgeR_obj objects returned count_motifs_graphs(). verbose Logical; print progress recomputing offsets.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/merge_motif_objs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Merge motif objects — merge_motif_objs","text":"two objects must disjoint sample names overlapping label sets; label sets disjoint merge stops error. Motif key names validated object's label levels merging. Per-sample graphs retained present inputs; label IDs remapped merged label vocabulary.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/merge_motif_objs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge motif objects — merge_motif_objs","text":"merged cellEdgeR_obj containing combined samples, offsets, normalized counts, relative counts, offset metadata recomputed merged data.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/merge_motif_objs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Merge motif objects — merge_motif_objs","text":"","code":"demo <- make_demo_samples(seed = 1, n_samples = 4) graphs_full <- build_cell_graphs(demo, verbose = FALSE) full <- count_motifs_graphs(graphs_full, max_edge_len = NA_real_, verbose = FALSE)  grp <- names(demo) obj_a <- count_motifs_graphs(build_cell_graphs(demo[grp[1:2]], verbose = FALSE), verbose = FALSE) obj_b <- count_motifs_graphs(build_cell_graphs(demo[grp[3:4]], verbose = FALSE), verbose = FALSE) merged <- merge_motif_objs(obj_a, obj_b, verbose = FALSE)"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/motif_edger.html","id":null,"dir":"Reference","previous_headings":"","what":"Differential motif testing with multiple strategies — motif_edger","title":"Differential motif testing with multiple strategies — motif_edger","text":"Fits multiple edgeR-based strategies across stacked motifs stores results later extraction.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/motif_edger.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Differential motif testing with multiple strategies — motif_edger","text":"","code":"motif_edger(cellgraph, sample_df, design_formula, verbose = TRUE,   merge_triplets = FALSE, strategies = c(\"volume\", \"ancova\"))"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/motif_edger.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Differential motif testing with multiple strategies — motif_edger","text":"cellgraph Output count_motifs_graphs(), containing motif counts offsets. sample_df Data frame sample metadata; row names must match cellgraph\\$sample_name. design_formula Formula string compatible stats::model.matrix() (e.g. ~ condition + batch). verbose Logical; print progress edgeR. merge_triplets TRUE, triangles wedges merged shared TW prefix fitting. strategies Character vector strategies run; defaults volume ancova.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/motif_edger.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Differential motif testing with multiple strategies — motif_edger","text":"Two strategies supported default: volume: volume offsets (Chung-Lu baseline) ancova: volume offsets plus edge-force covariates per triangle/wedge Use top_motifs extract ranked tables logFC FDR. hybrid summary combines volume (nodes/edges) ancova (triangles/wedges).","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/motif_edger.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Differential motif testing with multiple strategies — motif_edger","text":"input cellgraph augmented edger, containing: strategies Named list strategy results (volume, ancova). motif_info Data frame motif keys motif types joins. sample_df Sample metadata used build model matrix. merge_triplets Whether triangles+wedge merged.","code":""},{"path":[]},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/motif_edger.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Differential motif testing with multiple strategies — motif_edger","text":"","code":"cells <- list(   s1 = data.frame(x = c(0, 1, 0), y = c(0, 0, 1), label = c(\"A\", \"A\", \"B\")),   s2 = data.frame(x = c(0, 2, 0), y = c(0, 0, 2), label = c(\"A\", \"B\", \"B\")) ) graphs <- build_cell_graphs(cells, verbose = FALSE) motifs <- count_motifs_graphs(graphs, max_edge_len = 3) #> Counting node motifs (cells by label)… #> Counting edge motifs (unordered label pairs)… #> Counting triangle motifs (unordered label triplets) in C++… #> Counts ready: |labels|=2, singles=2, pairs=3, triangles=2 #> Warning: no non-missing arguments to max; returning -Inf #> Warning: no non-missing arguments to max; returning -Inf sample_df <- data.frame(condition = c(\"ctrl\", \"treated\"), row.names = motifs$sample_name) res <- motif_edger(motifs, sample_df, \"~ condition\") #> Fitting edgeR (QL) for volume offsets... #> Warning: No residual df: cannot estimate dispersion #> edgeR dispersion estimation failed for volume/full model; tests will be empty. #> Fitting ancova models (per motif)... #> Warning: No residual df: cannot estimate dispersion #> Warning: Ancova dispersion could not be estimated; returning NA results. head(top_motifs(res, strategy = \"volume\", coef = \"conditiontreated\")) #> Warning: No edgeR tests stored for volume coef: conditiontreated. Returning NA results. #>     motif motif_type logFC PValue FDR model_used #> 1     N_A       node    NA     NA  NA     volume #> 2     N_B       node    NA     NA  NA     volume #> 3   E_A_A       edge    NA     NA  NA     volume #> 4   E_A_B       edge    NA     NA  NA     volume #> 5   E_B_B       edge    NA     NA  NA     volume #> 6 T_A_A_B   triangle    NA     NA  NA     volume"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_motif_artifact_check.html","id":null,"dir":"Reference","previous_headings":"","what":"Artifact check: residuals versus edge density — plot_motif_artifact_check","title":"Artifact check: residuals versus edge density — plot_motif_artifact_check","text":"Plot per-sample log residuals edge-derived offsets total edge density.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_motif_artifact_check.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Artifact check: residuals versus edge density — plot_motif_artifact_check","text":"","code":"plot_motif_artifact_check(   cellgraph,   offset_mode = \"hier_null\",   layer = \"triangle\",   motif_key = NULL,   log_base = 2,   pseudocount = NULL,   smooth = TRUE )"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_motif_artifact_check.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Artifact check: residuals versus edge density — plot_motif_artifact_check","text":"cellgraph Output count_motifs_graphs() (motif_edger()) stored relative counts. offset_mode Offset set use residuals; defaults \"hier_null\". layer Motif layer plot; defaults \"triangle\". motif_key Optional character vector motif keys include; defaults motifs. log_base Logarithm base x-axis; defaults 2 match residuals. pseudocount Positive value added log transform; defaults cellgraph$parameters$offset_pseudo 1. smooth Logical; add linear trend line.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_motif_artifact_check.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Artifact check: residuals versus edge density — plot_motif_artifact_check","text":"ggplot object.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_motif_box.html","id":null,"dir":"Reference","previous_headings":"","what":"Boxplot of normalized motif counts (internal helper) — plot_motif_box","title":"Boxplot of normalized motif counts (internal helper) — plot_motif_box","text":"Visualize normalized motif counts (e.g., get_norm_counts()) across samples given motif.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_motif_box.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Boxplot of normalized motif counts (internal helper) — plot_motif_box","text":"","code":"plot_motif_box(   norm_counts,   motif_key,   layer = NULL,   sample_df = NULL,   group_var = NULL,   offset_mode = NULL )"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_motif_box.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Boxplot of normalized motif counts (internal helper) — plot_motif_box","text":"norm_counts List normalized counts (e.g., cellgraph$norm_counts count_motifs_graphs()); multiple offset modes present, select one via offset_mode. motif_key Character motif identifier prefix (e.g., \"E_A_B\"). layer layer plot; NULL, inferred motif prefix (N_, E_, T_, W_, TW_). sample_df Optional data frame sample metadata; rownames must match motif columns. group_var Optional column name sample_df use grouping/coloring boxplot.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_motif_box.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Boxplot of normalized motif counts (internal helper) — plot_motif_box","text":"ggplot object.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_motif_slope_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Slope test for geometric scaling — plot_motif_slope_test","title":"Slope test for geometric scaling — plot_motif_slope_test","text":"Compare observed triangle counts structural expectation sub-motif offsets using log-log regression.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_motif_slope_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Slope test for geometric scaling — plot_motif_slope_test","text":"","code":"plot_motif_slope_test(   cellgraph,   offset_mode = \"hier_null\",   layer = \"triangle\",   motif_key = NULL,   log_base = exp(1),   pseudocount = NULL )"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_motif_slope_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Slope test for geometric scaling — plot_motif_slope_test","text":"cellgraph Output count_motifs_graphs() (motif_edger()) stored offsets. offset_mode Offset set use expectation; defaults \"hier_null\". layer Motif layer plot; defaults \"triangle\". motif_key Optional character vector motif keys include; defaults motifs. log_base Logarithm base regression; defaults natural log. pseudocount Positive value added log transform; defaults cellgraph$parameters$offset_pseudo 1.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_motif_slope_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Slope test for geometric scaling — plot_motif_slope_test","text":"ggplot object fitted slope annotation.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_sample_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a sample graph with highlighted motifs — plot_sample_graph","title":"Plot a sample graph with highlighted motifs — plot_sample_graph","text":"Draw Delaunay edges cell coordinates single sample, optionally highlighting motif labels (edges connecting labels).","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_sample_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a sample graph with highlighted motifs — plot_sample_graph","text":"","code":"plot_sample_graph(   graph_obj,   sample_name,   max_edge_len = Inf,   highlight_labels = NULL,   motif_key = NULL,   motif_layer = NULL,   cells_by_sample = NULL,   motif_node_size = 3,   dim_node_nonmotif = 0.6,   alpha_node_nonmotif = 0.4,   alpha_edge_nonmotif = 0.3 )"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_sample_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a sample graph with highlighted motifs — plot_sample_graph","text":"graph_obj Output build_cell_graphs() stored coordinates. sample_name Sample name plot. max_edge_len Optional numeric threshold prune long edges display; set Inf keep . highlight_labels Optional character vector labels emphasize. motif_key Optional motif identifier (e.g., \"E_A_B\"); provided, labels key highlighted edges connecting labels accentuated. motif_layer Layer motif key; NULL, inferred motif prefix. cells_by_sample Optional named list raw sample data frames; used graph_obj lacks stored coordinates (backward compatibility older objects). motif_node_size Size nodes participating highlighted motif. dim_node_nonmotif Factor shrink nodes highlighted motif. alpha_node_nonmotif Alpha nodes highlighted motif. alpha_edge_nonmotif Alpha edges highlighted motif.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/plot_sample_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a sample graph with highlighted motifs — plot_sample_graph","text":"ggplot object.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/top_motifs.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract top motifs from stored strategies — top_motifs","title":"Extract top motifs from stored strategies — top_motifs","text":"Returns ranked data frame motifs using strategy results stored motif_edger.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/top_motifs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract top motifs from stored strategies — top_motifs","text":"","code":"top_motifs(cellgraph, strategy = c(\"hybrid\", \"ancova\", \"volume\"),   coef = NULL, model = c(\"full\", \"null\"), n = Inf, fdr_method = \"BH\",   append_strategies = NULL)"},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/top_motifs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract top motifs from stored strategies — top_motifs","text":"cellgraph cellEdgeR_obj edger results. strategy strategy use: hybrid, ancova, volume (defaults hybrid; hybrid applies volume node/edge motifs ancova triangle/wedge motifs). coef Coefficient name index; defaults first non-intercept coefficient, intercept intercept present. model stored model use edgeR strategies: full null. n Number motifs return; defaults . fdr_method Multiple testing correction method p.adjust (default BH). append_strategies Optional vector strategies append raw PValues/logFC . Use TRUE append strategies.","code":""},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/top_motifs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract top motifs from stored strategies — top_motifs","text":"data frame columns: motif, motif\\_type, logFC, PValue, FDR, model\\_used. Additional logFC_<strategy> PValue_<strategy> columns added requested. hybrid, FDR computed separately node/edge motifs triangle/wedge motifs.","code":""},{"path":[]},{"path":"https://GeNeHetX.github.io/CellEdgeR/reference/top_motifs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract top motifs from stored strategies — top_motifs","text":"","code":"cells <- list(   s1 = data.frame(x = c(0, 1, 0), y = c(0, 0, 1), label = c(\"A\", \"A\", \"B\")),   s2 = data.frame(x = c(0, 2, 0), y = c(0, 0, 2), label = c(\"A\", \"B\", \"B\")) ) graphs <- build_cell_graphs(cells, verbose = FALSE) motifs <- count_motifs_graphs(graphs, max_edge_len = 3) #> Counting node motifs (cells by label)… #> Counting edge motifs (unordered label pairs)… #> Counting triangle motifs (unordered label triplets) in C++… #> Counts ready: |labels|=2, singles=2, pairs=3, triangles=2 #> Warning: no non-missing arguments to max; returning -Inf #> Warning: no non-missing arguments to max; returning -Inf sample_df <- data.frame(condition = c(\"ctrl\", \"treated\"), row.names = motifs$sample_name) res <- motif_edger(motifs, sample_df, \"~ condition\") #> Fitting edgeR (QL) for volume offsets... #> Warning: No residual df: cannot estimate dispersion #> edgeR dispersion estimation failed for volume/full model; tests will be empty. #> Fitting ancova models (per motif)... #> Warning: No residual df: cannot estimate dispersion #> Warning: Ancova dispersion could not be estimated; returning NA results. top_motifs(res, strategy = \"volume\", coef = \"conditiontreated\") #> Warning: No edgeR tests stored for volume coef: conditiontreated. Returning NA results. #>     motif motif_type logFC PValue FDR model_used #> 1     N_A       node    NA     NA  NA     volume #> 2     N_B       node    NA     NA  NA     volume #> 3   E_A_A       edge    NA     NA  NA     volume #> 4   E_A_B       edge    NA     NA  NA     volume #> 5   E_B_B       edge    NA     NA  NA     volume #> 6 T_A_A_B   triangle    NA     NA  NA     volume #> 7 T_A_B_B   triangle    NA     NA  NA     volume"}]
